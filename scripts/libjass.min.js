/**
* libjass
*
* https://github.com/Arnavion/libjass
*
* Copyright 2013 Arnav Singh
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*    http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
"use strict";var global=(0,eval)("this"),libjass;!function(e){var t=function(){function e(){this.clear()}return e.prototype.add=function(e){var t=this._ar(e);if(null===t)throw new Error("This Set implementation only supports Number and String values.");return this._L[t]=e,this},e.prototype.clear=function(){this._L=Object.create(null)},e.prototype.has=function(e){var t=this._ar(e);return null===t?!1:t in this._L},e.prototype.forEach=function(e,t){var r=this;Object.keys(this._L).map(function(n){var i=r._L[n];e.call(t,i,i,r)})},e.prototype.delete=function(){throw new Error("This Set implementation doesn't support delete().")},Object.defineProperty(e.prototype,"size",{get:function(){throw new Error("This Set implementation doesn't support size.")},enumerable:!0,configurable:!0}),e.prototype._ar=function(e){return"number"==typeof e?"#"+e:"string"==typeof e?"'"+e:null},e}();e.Set,e.Set="undefined"!=typeof global.Set&&"function"==typeof global.Set.prototype.forEach?global.Set:t;var r=function(){function e(){this.clear()}return e.prototype.get=function(e){var t=this._H(e);return null===t?void 0:this._I[t]},e.prototype.has=function(e){var t=this._H(e);return null===t?!1:t in this._u},e.prototype.set=function(e,t){var r=this._H(e);if(null===r)throw new Error("This Map implementation only supports Number and String keys.");return this._u[r]=e,this._I[r]=t,this},e.prototype.delete=function(e){var t=this._H(e);if(null===t)return!1;var r=t in this._u;return r&&(delete this._u[t],delete this._I[t]),r},e.prototype.clear=function(){this._u=Object.create(null),this._I=Object.create(null)},e.prototype.forEach=function(e,t){for(var r=Object.keys(this._u),n=0;n<r.length;n++){var i=r[n];e.call(t,this._I[i],this._u[i],this)}},Object.defineProperty(e.prototype,"size",{get:function(){throw new Error("This Map implementation doesn't support size.")},enumerable:!0,configurable:!0}),e.prototype._H=function(e){return"number"==typeof e?"#"+e:"string"==typeof e?"'"+e:null},e}();e.Map,e.Map="undefined"!=typeof global.Map&&"function"==typeof global.Map.prototype.forEach?global.Map:r}(libjass||(libjass={}));var module;module&&module.exports&&(module.exports=libjass);var __extends=this._a1||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r};!function(e){!function(e){var t=function(){function e(e,t,r,n){"undefined"==typeof n&&(n=1),this._6=e,this._ae=t,this._aa=r,this._as=n}return Object.defineProperty(e.prototype,"red",{get:function(){return this._6},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"green",{get:function(){return this._ae},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blue",{get:function(){return this._aa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._as},enumerable:!0,configurable:!0}),e.prototype.withAlpha=function(t){return null!==t?new e(this._6,this._ae,this._aa,t):this},e.prototype.toString=function(){return"rgba("+this._6+", "+this._ae+", "+this._aa+", "+this._as+")"},e}();e.Color=t;var r=function(){function e(e){for(var t=[],r=0;r<arguments.length-1;r++)t[r]=arguments[r+1];this._8=e,this._ao=t}return e.prototype.toString=function(){var e=this;return this._8+" { "+this._ao.map(function(t){return t+": "+e[t]}).join(", ")+(this._ao.length>0?" ":"")+"}"},e}();e.PartBase=r;var n=function(e){function t(t){e.call(this,"Comment","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Comment=n;var i=function(e){function t(t){e.call(this,"Text","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"Text { value: "+this._a.replace(/\u00A0/g,"\\h").replace(/\n/g,"\\N")+" }"},t}(r);e.Text=i;var a=function(e){function t(t){e.call(this,"Italic","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Italic=a;var o=function(e){function t(t){e.call(this,"Bold","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Bold=o;var l=function(e){function t(t){e.call(this,"Underline","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Underline=l;var s=function(e){function t(t){e.call(this,"StrikeThrough","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.StrikeThrough=s;var u=function(e){function t(t){e.call(this,"Border","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Border=u;var p=function(e){function t(t){e.call(this,"BorderX","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.BorderX=p;var c=function(e){function t(t){e.call(this,"BorderY","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.BorderY=c;var h=function(e){function t(t){e.call(this,"Shadow","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Shadow=h;var f=function(e){function t(t){e.call(this,"ShadowX","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.ShadowX=f;var _=function(e){function t(t){e.call(this,"ShadowY","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.ShadowY=_;var d=function(e){function t(t){e.call(this,"Blur","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Blur=d;var g=function(e){function t(t){e.call(this,"Blur","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.GaussianBlur=g;var v=function(e){function t(t){e.call(this,"FontName","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.FontName=v;var y=function(e){function t(t){e.call(this,"FontSize","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.FontSize=y;var m=function(e){function t(t){e.call(this,"FontScaleX","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.FontScaleX=m;var b=function(e){function t(t){e.call(this,"FontScaleX","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.FontScaleY=b;var w=function(e){function t(t){e.call(this,"LetterSpacing","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.LetterSpacing=w;var O=function(e){function t(t){e.call(this,"RotateX","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.RotateX=O;var S=function(e){function t(t){e.call(this,"RotateY","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.RotateY=S;var P=function(e){function t(t){e.call(this,"RotateZ","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.RotateZ=P;var x=function(e){function t(t){e.call(this,"SkewX","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.SkewX=x;var j=function(e){function t(t){e.call(this,"SkewY","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.SkewY=j;var k=function(e){function t(t){e.call(this,"PrimaryColor","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.PrimaryColor=k;var E=function(e){function t(t){e.call(this,"SecondaryColor","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.SecondaryColor=E;var C=function(e){function t(t){e.call(this,"OutlineColor","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.OutlineColor=C;var T=function(e){function t(t){e.call(this,"ShadowColor","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.ShadowColor=T;var F=function(e){function t(t){e.call(this,"Alpha","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Alpha=F;var M=function(e){function t(t){e.call(this,"PrimaryAlpha","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.PrimaryAlpha=M;var A=function(e){function t(t){e.call(this,"SecondaryAlpha","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.SecondaryAlpha=A;var X=function(e){function t(t){e.call(this,"OutlineAlpha","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.OutlineAlpha=X;var Y=function(e){function t(t){e.call(this,"ShadowAlpha","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.ShadowAlpha=Y;var R=function(e){function t(t){e.call(this,"Alignment","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Alignment=R;var V=function(e){function t(t){e.call(this,"ColorKaraoke","duration"),this._E=t}return __extends(t,e),Object.defineProperty(t.prototype,"duration",{get:function(){return this._E},enumerable:!0,configurable:!0}),t}(r);e.ColorKaraoke=V;var W=function(e){function t(t){e.call(this,"SweepingColorKaraoke","duration"),this._E=t}return __extends(t,e),Object.defineProperty(t.prototype,"duration",{get:function(){return this._E},enumerable:!0,configurable:!0}),t}(r);e.SweepingColorKaraoke=W;var N=function(e){function t(t){e.call(this,"OutlineKaraoke","duration"),this._E=t}return __extends(t,e),Object.defineProperty(t.prototype,"duration",{get:function(){return this._E},enumerable:!0,configurable:!0}),t}(r);e.OutlineKaraoke=N;var I=function(e){function t(t){e.call(this,"WrappingStyle","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.WrappingStyle=I;var D=function(e){function t(t){e.call(this,"Reset","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.Reset=D;var L=function(e){function t(t,r){e.call(this,"Position","x","y"),this._Y=t,this._2=r}return __extends(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this._Y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._2},enumerable:!0,configurable:!0}),t}(r);e.Position=L;var B=function(e){function t(t,r,n,i,a,o){e.call(this,"Move","x1","y1","x2","y2","t1","t2"),this._1=t,this.__=r,this._Q=n,this._X=i,this._W=a,this._V=o}return __extends(t,e),Object.defineProperty(t.prototype,"x1",{get:function(){return this._1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y1",{get:function(){return this.__},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x2",{get:function(){return this._Q},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y2",{get:function(){return this._X},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"t1",{get:function(){return this._W},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"t2",{get:function(){return this._V},enumerable:!0,configurable:!0}),t}(r);e.Move=B;var z=function(e){function t(t,r){e.call(this,"RotationOrigin","x","y"),this._Y=t,this._2=r}return __extends(t,e),Object.defineProperty(t.prototype,"x",{get:function(){return this._Y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._2},enumerable:!0,configurable:!0}),t}(r);e.RotationOrigin=z;var U=function(e){function t(t,r){e.call(this,"Fade","start","end"),this._g=t,this._f=r}return __extends(t,e),Object.defineProperty(t.prototype,"start",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._f},enumerable:!0,configurable:!0}),t}(r);e.Fade=U;var H=function(e){function t(t,r,n,i,a,o,l){e.call(this,"ComplexFade","a1","a2","a3","t1","t2","t3","t4"),this._aF=t,this._aK=r,this._aN=n,this._W=i,this._V=a,this._aO=o,this._aB=l}return __extends(t,e),Object.defineProperty(t.prototype,"a1",{get:function(){return this._aF},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"a2",{get:function(){return this._aK},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"a3",{get:function(){return this._aN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"t1",{get:function(){return this._W},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"t2",{get:function(){return this._V},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"t3",{get:function(){return this._aO},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"t4",{get:function(){return this._aB},enumerable:!0,configurable:!0}),t}(r);e.ComplexFade=H;var K=function(e){function t(t,r,n,i){e.call(this,"Transform","start","end","accel","tags"),this._g=t,this._f=r,this._aQ=n,this._aY=i}return __extends(t,e),Object.defineProperty(t.prototype,"start",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._f},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accel",{get:function(){return this._aQ},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tags",{get:function(){return this._aY},enumerable:!0,configurable:!0}),t}(r);e.Transform=K;var q=function(e){function t(t,r,n,i,a){e.call(this,"RectangularClip","x1","y1","x2","y2","inside"),this._1=t,this.__=r,this._Q=n,this._X=i,this._S=a}return __extends(t,e),Object.defineProperty(t.prototype,"x1",{get:function(){return this._1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y1",{get:function(){return this.__},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x2",{get:function(){return this._Q},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y2",{get:function(){return this._X},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inside",{get:function(){return this._S},enumerable:!0,configurable:!0}),t}(r);e.RectangularClip=q;var G=function(e){function t(t,r,n){e.call(this,"VectorClip","scale","commands","inside"),this._a$=t,this._a_=r,this._S=n}return __extends(t,e),Object.defineProperty(t.prototype,"scale",{get:function(){return this._a$},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"commands",{get:function(){return this._a_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inside",{get:function(){return this._S},enumerable:!0,configurable:!0}),t}(r);e.VectorClip=G;var Z=function(e){function t(t){e.call(this,"DrawingMode","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.DrawingMode=Z;var J=function(e){function t(t){e.call(this,"DrawingBaselineOffset","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.DrawingBaselineOffset=J;var Q=function(e){function t(t){e.call(this,"DrawingInstructions","value"),this._a=t}return __extends(t,e),Object.defineProperty(t.prototype,"value",{get:function(){return this._a},enumerable:!0,configurable:!0}),t}(r);e.DrawingInstructions=Q}(e.parts||(e.parts={}))}(libjass||(libjass={})),function(e){!function(t){function r(e,t){"undefined"==typeof t&&(t="dialogueParts");var r=new i(e,t);if(null===r.result||r.result.end!==e.length)throw new Error("Parse failed.");return r.result.value}function n(e,t,r,n){i.prototype["parse_tag_"+e]=function(i){var a=this,l=new o(i);if(null===a.read(l,e))return i.pop(),null;var s=r.call(a,l);if(null!==s)l.value=new t(s.value);else{if(!n)return i.pop(),null;l.value=new t(null)}return l}}t.parse=r;var i=function(){function t(e,t){this._am=e,this._$=new o(null),this._aS=a.get(t).call(this,this._$)}return Object.defineProperty(t.prototype,"result",{get:function(){return this._aS},enumerable:!0,configurable:!0}),t.prototype.parse_script=function(e){var t=new o(e);for(t.value=Object.create(null);this._d();){var r=this.parse_scriptSection(t);if(null!==r)t.value[r.value.name]=r.value.contents;else if(null===this.read(t,"\n"))return e.pop(),null}return t},t.prototype.parse_scriptSection=function(e){var t=new o(e);t.value=Object.create(null),t.value.contents=null;var r=this.parse_scriptSectionHeader(t);if(null===r)return e.pop(),null;t.value.name=r.value;for(var n=null;this._d()&&"["!==this._b();){var i=this.parse_scriptProperty(t);if(null!==i){var a=i.value;if("Format"===a.key)n=a.value.split(",").map(function(e){return e.trim()});else if(null!==n){null===t.value.contents&&(t.value.contents=[]);var l=Object.create(null),s=a.value.split(",");s.length>n.length&&(s[n.length-1]=s.slice(n.length-1).join(",")),n.forEach(function(e,t){l[e]=s[t]}),t.value.contents.push({type:a.key,template:l})}else null===t.value.contents&&(t.value.contents=Object.create(null)),t.value.contents[a.key]=a.value}else if(null===this.parse_scriptComment(t)&&null===this.read(t,"\n"))return e.pop(),null}return t},t.prototype.parse_scriptSectionHeader=function(e){var t=new o(e);if(null===this.read(t,"["))return e.pop(),null;for(var r=new o(t,""),n=this._b();this._d()&&"]"!==n&&"\n"!==n;n=this._b())r.value+=n;return 0===r.value.length?(e.pop(),null):(t.value=r.value,null===this.read(t,"]")?(e.pop(),null):t)},t.prototype.parse_scriptProperty=function(e){var t=new o(e);t.value=Object.create(null);var r,n=new o(t,"");for(r=this._b();this._d()&&":"!==r&&"\n"!==r;r=this._b())n.value+=r;if(0===n.value.length)return e.pop(),null;if(null===this.read(t,":"))return e.pop(),null;var i=new o(t,"");for(r=this._b();" "===r;r=this._b())i.value+=r;var a=new o(t,"");for(r=this._b();this._d()&&"\n"!==r;r=this._b())a.value+=r;return t.value.key=n.value,t.value.value=a.value,t},t.prototype.parse_scriptComment=function(e){var t=new o(e);if(null===this.read(t,";"))return e.pop(),null;for(var r=new o(t,""),n=this._b();this._d()&&"\n"!==n;n=this._b())r.value+=n;return t.value=r.value,t},t.prototype.parse_dialogueParts=function(t){var r=new o(t);r.value=[];for(var n=!1;this._d();){var i=this.parse_enclosedTags(r);if(null!==i)i.value.forEach(function(t){t instanceof e.parts.DrawingMode&&(n=0!==t.value)}),r.value.push.apply(r.value,i.value);else{var a=this.parse_newline(r)||this.parse_hardspace(r)||this.parse_text(r);if(null===a)return t.pop(),null;if(n){var l=a.value.value;r.value[r.value.length-1]instanceof e.parts.DrawingInstructions?r.value[r.value.length-1]=new e.parts.DrawingInstructions(r.value[r.value.length-1].value+l):r.value.push(new e.parts.DrawingInstructions(a.value.value))}else r.value[r.value.length-1]instanceof e.parts.Text?r.value[r.value.length-1]=new e.parts.Text(r.value[r.value.length-1].value+a.value.value):r.value.push(a.value)}}return r},t.prototype.parse_enclosedTags=function(t){var r=new o(t);if(r.value=[],null===this.read(r,"{"))return t.pop(),null;for(var n=this._b();this._d()&&"}"!==n;n=this._b()){var i=null;if(null!==this.read(r,"\\")&&(i=this.parse_tag_alpha(r)||this.parse_tag_iclip(r)||this.parse_tag_xbord(r)||this.parse_tag_ybord(r)||this.parse_tag_xshad(r)||this.parse_tag_yshad(r)||this.parse_tag_blur(r)||this.parse_tag_bord(r)||this.parse_tag_clip(r)||this.parse_tag_fade(r)||this.parse_tag_fscx(r)||this.parse_tag_fscy(r)||this.parse_tag_move(r)||this.parse_tag_shad(r)||this.parse_tag_fad(r)||this.parse_tag_fax(r)||this.parse_tag_fay(r)||this.parse_tag_frx(r)||this.parse_tag_fry(r)||this.parse_tag_frz(r)||this.parse_tag_fsp(r)||this.parse_tag_org(r)||this.parse_tag_pbo(r)||this.parse_tag_pos(r)||this.parse_tag_an(r)||this.parse_tag_be(r)||this.parse_tag_fn(r)||this.parse_tag_fr(r)||this.parse_tag_fs(r)||this.parse_tag_kf(r)||this.parse_tag_ko(r)||this.parse_tag_1a(r)||this.parse_tag_1c(r)||this.parse_tag_2a(r)||this.parse_tag_2c(r)||this.parse_tag_3a(r)||this.parse_tag_3c(r)||this.parse_tag_4a(r)||this.parse_tag_4c(r)||this.parse_tag_a(r)||this.parse_tag_b(r)||this.parse_tag_c(r)||this.parse_tag_i(r)||this.parse_tag_k(r)||this.parse_tag_K(r)||this.parse_tag_p(r)||this.parse_tag_q(r)||this.parse_tag_r(r)||this.parse_tag_s(r)||this.parse_tag_t(r)||this.parse_tag_u(r),null===i&&r.pop()),null===i&&(i=this.parse_comment(r)),null===i)return t.pop(),null;i.value instanceof e.parts.Comment&&r.value[r.value.length-1]instanceof e.parts.Comment?r.value[r.value.length-1]=new e.parts.Comment(r.value[r.value.length-1].value+i.value.value):r.value.push(i.value)}return null===this.read(r,"}")?(t.pop(),null):r},t.prototype.parse_newline=function(t){var r=new o(t);return null===this.read(r,"\\N")?(t.pop(),null):(r.value=new e.parts.Text("\n"),r)},t.prototype.parse_hardspace=function(t){var r=new o(t);return null===this.read(r,"\\h")?(t.pop(),null):(r.value=new e.parts.Text("Â "),r)},t.prototype.parse_text=function(t){var r=this._b(),n=new o(t),i=new o(n,r);return n.value=new e.parts.Text(i.value),n},t.prototype.parse_comment=function(t){var r=this._b(),n=new o(t),i=new o(n,r);return n.value=new e.parts.Comment(i.value),n},t.prototype.parse_tag_a=function(t){var r=new o(t);if(null===this.read(r,"a"))return t.pop(),null;var n=this._b();switch(n){case"1":var i=this._b(2);switch(i){case"10":case"11":n=i}break;case"2":case"3":case"5":case"6":case"7":case"9":break;default:return t.pop(),null}var a=new o(r,n),l=null;switch(a.value){case"1":l=1;break;case"2":l=2;break;case"3":l=3;break;case"5":l=7;break;case"6":l=8;break;case"7":l=9;break;case"9":l=4;break;case"10":l=5;break;case"11":l=6}return r.value=new e.parts.Alignment(l),r},t.prototype.parse_tag_alpha=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_an=function(t){var r=new o(t);if(null===this.read(r,"an"))return t.pop(),null;var n=this._b();if("1">n||n>"9")return t.pop(),null;var i=new o(r,n);return r.value=new e.parts.Alignment(parseInt(i.value)),r},t.prototype.parse_tag_b=function(t){var r=new o(t);if(null===this.read(r,"b"))return t.pop(),null;var n=null,i=this._b();return i>="1"&&"9">=i&&(i=this._b(3),"00"===i.substr(1)&&(n=new o(r,i),n.value=parseInt(n.value))),null===n&&(n=this.parse_enableDisable(r)),r.value=null!==n?new e.parts.Bold(n.value):new e.parts.Bold(null),r},t.prototype.parse_tag_be=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_blur=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_bord=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_c=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_clip=function(t){var r=new o(t);if(null===this.read(r,"clip"))return t.pop(),null;var n=null,i=null,a=null,l=null,s=null,u=null,p=this.parse_decimal(r);if(null!==p){if(null===this.read(r,","))return t.pop(),null;var c=this.parse_decimal(r);null!==c?(n=p,a=c):s=p}if(null!==n&&null!==a){if(null===this.read(r,","))return t.pop(),null;if(i=this.parse_decimal(r),null===this.read(r,","))return t.pop(),null;l=this.parse_decimal(r),r.value=new e.parts.RectangularClip(n.value,a.value,i.value,l.value,!0)}else{u=new o(r,"");for(var h=this._b();this._d()&&")"!==h&&"}"!==h;h=this._b())u.value+=h;r.value=new e.parts.VectorClip(null!==s?s.value:1,u.value,!0)}return null===this.read(r,")")?(t.pop(),null):r},t.prototype.parse_tag_fad=function(t){var r=new o(t);if(null===this.read(r,"fad"))return t.pop(),null;if(null===this.read(r,"("))return t.pop(),null;var n=this.parse_decimal(r);if(null===n)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var i=this.parse_decimal(r);return null===i?(t.pop(),null):null===this.read(r,")")?(t.pop(),null):(r.value=new e.parts.Fade(n.value/1e3,i.value/1e3),r)},t.prototype.parse_tag_fade=function(t){var r=new o(t);if(null===this.read(r,"fade"))return t.pop(),null;if(null===this.read(r,"("))return t.pop(),null;var n=this.parse_decimal(r);if(null===n)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var i=this.parse_decimal(r);if(null===i)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var a=this.parse_decimal(r);if(null===a)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var l=this.parse_decimal(r);if(null===l)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var s=this.parse_decimal(r);if(null===s)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var u=this.parse_decimal(r);if(null===u)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var p=this.parse_decimal(r);return null===p?(t.pop(),null):null===this.read(r,")")?(t.pop(),null):(r.value=new e.parts.ComplexFade(1-n.value/255,1-i.value/255,1-a.value/255,l.value/1e3,s.value/1e3,u.value/1e3,p.value/1e3),r)},t.prototype.parse_tag_fax=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_fay=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_fn=function(t){var r=new o(t);if(null===this.read(r,"fn"))return t.pop(),null;for(var n=new o(r,""),i=this._b();this._d()&&"\\"!==i&&"}"!==i;i=this._b())n.value+=i;return r.value=n.value.length>0?new e.parts.FontName(n.value):new e.parts.FontName(null),r},t.prototype.parse_tag_fr=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_frx=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_fry=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_frz=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_fs=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_fscx=function(t){var r=new o(t);if(null===this.read(r,"fscx"))return t.pop(),null;var n=this.parse_decimal(r);return null===n?(t.pop(),null):(r.value=new e.parts.FontScaleX(n.value/100),r)},t.prototype.parse_tag_fscy=function(t){var r=new o(t);if(null===this.read(r,"fscy"))return t.pop(),null;var n=this.parse_decimal(r);return null===n?(t.pop(),null):(r.value=new e.parts.FontScaleY(n.value/100),r)},t.prototype.parse_tag_fsp=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_i=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_iclip=function(t){var r=new o(t);if(null===this.read(r,"iclip"))return t.pop(),null;var n=null,i=null,a=null,l=null,s=null,u=null,p=this.parse_decimal(r);if(null!==p){if(null===this.read(r,","))return t.pop(),null;var c=this.parse_decimal(r);null!==c?(n=p,a=c):s=p}if(null!==n&&null!==a){if(null===this.read(r,","))return t.pop(),null;if(i=this.parse_decimal(r),null===this.read(r,","))return t.pop(),null;l=this.parse_decimal(r),r.value=new e.parts.RectangularClip(n.value,a.value,i.value,l.value,!1)}else{u=new o(r,"");for(var h=this._b();this._d()&&")"!==h&&"}"!==h;h=this._b())u.value+=h;r.value=new e.parts.VectorClip(null!==s?s.value:1,u.value,!1)}return null===this.read(r,")")?(t.pop(),null):r},t.prototype.parse_tag_k=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_K=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_kf=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_ko=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_move=function(t){var r=new o(t);if(null===this.read(r,"move"))return t.pop(),null;if(null===this.read(r,"("))return t.pop(),null;var n=this.parse_decimal(r);if(null===n)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var i=this.parse_decimal(r);if(null===i)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var a=this.parse_decimal(r);if(null===a)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var l=this.parse_decimal(r);if(null===l)return t.pop(),null;var s=null,u=null;if(null!==this.read(r,",")){if(s=this.parse_decimal(r),null===s)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;if(u=this.parse_decimal(r),null===u)return t.pop(),null}return null===this.read(r,")")?(t.pop(),null):(r.value=new e.parts.Move(n.value,i.value,a.value,l.value,null!==s?s.value/1e3:null,null!==u?u.value/1e3:null),r)},t.prototype.parse_tag_org=function(t){var r=new o(t);if(null===this.read(r,"org"))return t.pop(),null;if(null===this.read(r,"("))return t.pop(),null;var n=this.parse_decimal(r);if(null===n)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var i=this.parse_decimal(r);return null===i?(t.pop(),null):null===this.read(r,")")?(t.pop(),null):(r.value=new e.parts.RotationOrigin(n.value,i.value),r)},t.prototype.parse_tag_p=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_pbo=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_pos=function(t){var r=new o(t);if(null===this.read(r,"pos"))return t.pop(),null;if(null===this.read(r,"("))return t.pop(),null;var n=this.parse_decimal(r);if(null===n)return t.pop(),null;if(null===this.read(r,","))return t.pop(),null;var i=this.parse_decimal(r);return null===i?(t.pop(),null):null===this.read(r,")")?(t.pop(),null):(r.value=new e.parts.Position(n.value,i.value),r)},t.prototype.parse_tag_q=function(t){var r=new o(t);if(null===this.read(r,"q"))return t.pop(),null;var n=this._b();if("0">n||n>"3")return t.pop(),null;var i=new o(r,n);return r.value=new e.parts.WrappingStyle(parseInt(i.value)),r},t.prototype.parse_tag_r=function(t){var r=new o(t);if(null===this.read(r,"r"))return t.pop(),null;for(var n=new o(r,""),i=this._b();this._d()&&"\\"!==i&&"}"!==i;i=this._b())n.value+=i;return r.value=n.value.length>0?new e.parts.Reset(n.value):new e.parts.Reset(null),r},t.prototype.parse_tag_s=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_shad=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_t=function(t){var r=new o(t);if(null===this.read(r,"t"))return t.pop(),null;
if(null===this.read(r,"("))return t.pop(),null;var n=null,i=null,a=null,l=this.parse_decimal(r);if(null!==l){if(null===this.read(r,","))return t.pop(),null;var s=this.parse_decimal(r);if(null!==s){if(n=l,i=s,null===this.read(r,","))return t.pop(),null;var u=this.parse_decimal(r);if(null!==u&&(a=u,null===this.read(r,",")))return t.pop(),null}else if(a=l,null===this.read(r,","))return t.pop(),null}for(var p=[],c=this._b();this._d()&&")"!==c&&"}"!==c;c=this._b()){var h=null;if(null!==this.read(r,"\\")&&(h=this.parse_tag_alpha(r)||this.parse_tag_iclip(r)||this.parse_tag_xbord(r)||this.parse_tag_ybord(r)||this.parse_tag_xshad(r)||this.parse_tag_yshad(r)||this.parse_tag_blur(r)||this.parse_tag_bord(r)||this.parse_tag_clip(r)||this.parse_tag_fscx(r)||this.parse_tag_fscy(r)||this.parse_tag_shad(r)||this.parse_tag_fax(r)||this.parse_tag_fay(r)||this.parse_tag_frx(r)||this.parse_tag_fry(r)||this.parse_tag_frz(r)||this.parse_tag_fsp(r)||this.parse_tag_be(r)||this.parse_tag_fr(r)||this.parse_tag_fs(r)||this.parse_tag_1a(r)||this.parse_tag_1c(r)||this.parse_tag_2a(r)||this.parse_tag_2c(r)||this.parse_tag_3a(r)||this.parse_tag_3c(r)||this.parse_tag_4a(r)||this.parse_tag_4c(r)||this.parse_tag_c(r),null===h&&r.pop()),null===h&&(h=this.parse_comment(r)),null===h)return t.pop(),null;h.value instanceof e.parts.Comment&&p[p.length-1]instanceof e.parts.Comment?p[p.length-1]=new e.parts.Comment(p[p.length-1].value+h.value.value):p.push(h.value)}return this.read(r,")"),r.value=new e.parts.Transform(null!==n?n.value/1e3:null,null!==i?i.value/1e3:null,null!==a?a.value/1e3:null,p),r},t.prototype.parse_tag_u=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_xbord=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_xshad=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_ybord=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_yshad=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_1a=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_1c=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_2a=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_2c=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_3a=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_3c=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_4a=function(){throw new Error("Method not implemented.")},t.prototype.parse_tag_4c=function(){throw new Error("Method not implemented.")},t.prototype.parse_decimal=function(e){var t=new o(e),r=null!==this.read(t,"-"),n=this.parse_unsignedDecimal(t);return null===n?(e.pop(),null):(t.value=n.value,r&&(t.value=-t.value),t)},t.prototype.parse_unsignedDecimal=function(e){var t,r=new o(e),n=new o(r,""),i=null;for(t=this._b();this._d()&&t>="0"&&"9">=t;t=this._b())n.value+=t;if(0===n.value.length)return e.pop(),null;if(null!==this.read(r,".")){for(i=new o(r,""),t=this._b();this._d()&&t>="0"&&"9">=t;t=this._b())i.value+=t;if(0===i.value.length)return e.pop(),null}return r.value=parseFloat(n.value+(null!==i?"."+i.value:"")),r},t.prototype.parse_enableDisable=function(e){var t=this._b();if("0"===t||"1"===t){var r=new o(e,t);return r.value="1"===r.value,r}return null},t.prototype.parse_hex=function(e){var t=this._b();return t>="0"&&"9">=t||t>="a"&&"f">=t||t>="A"&&"F">=t?new o(e,t):null},t.prototype.parse_color=function(t){var r=new o(t);if(null===this.read(r,"&"))return t.pop(),null;this.read(r,"H");for(var n=Array(6),i=0;i<n.length;i++){var a=this.parse_hex(r);if(null===a)return t.pop(),null;n[i]=a}return null!==this.read(r,"0")&&null===this.read(r,"0")?(t.pop(),null):null===this.read(r,"&")?(t.pop(),null):(r.value=new e.parts.Color(parseInt(n[4].value+n[5].value,16),parseInt(n[2].value+n[3].value,16),parseInt(n[0].value+n[1].value,16)),r)},t.prototype.parse_alpha=function(e){var t=new o(e);null!==this.read(t,"&")&&this.read(t,"H");var r=this.parse_hex(t);if(null===r)return e.pop(),null;var n=this.parse_hex(t);return this.read(t,"&"),t.value=1-parseInt(r.value+(null!==n?n:r).value,16)/255,t},t.prototype.parse_colorWithAlpha=function(t){var r=new o(t);if(null===this.read(r,"&H"))return t.pop(),null;for(var n=Array(8),i=0;i<n.length;i++){var a=this.parse_hex(r);if(null===a)return t.pop(),null;n[i]=a}return r.value=new e.parts.Color(parseInt(n[6].value+n[7].value,16),parseInt(n[4].value+n[5].value,16),parseInt(n[2].value+n[3].value,16),1-parseInt(n[0].value+n[1].value,16)/255),r},t.prototype._b=function(e){return"undefined"==typeof e&&(e=1),this._am.substr(this._$.end,e)},t.prototype.read=function(e,t){return this._b(t.length)!==t?null:new o(e,t)},t.prototype._d=function(){return this._$.end<this._am.length},t}();n("alpha",e.parts.Alpha,i.prototype.parse_alpha,!1),n("be",e.parts.Blur,i.prototype.parse_decimal,!1),n("blur",e.parts.GaussianBlur,i.prototype.parse_decimal,!1),n("bord",e.parts.Border,i.prototype.parse_decimal,!1),n("c",e.parts.PrimaryColor,i.prototype.parse_color,!1),n("fax",e.parts.SkewX,i.prototype.parse_decimal,!1),n("fay",e.parts.SkewY,i.prototype.parse_decimal,!1),n("fr",e.parts.RotateZ,i.prototype.parse_decimal,!1),n("frx",e.parts.RotateX,i.prototype.parse_decimal,!1),n("fry",e.parts.RotateY,i.prototype.parse_decimal,!1),n("frz",e.parts.RotateZ,i.prototype.parse_decimal,!1),n("fs",e.parts.FontSize,i.prototype.parse_decimal,!1),n("fsp",e.parts.LetterSpacing,i.prototype.parse_decimal,!1),n("i",e.parts.Italic,i.prototype.parse_enableDisable,!1),n("k",e.parts.ColorKaraoke,i.prototype.parse_decimal,!0),n("K",e.parts.SweepingColorKaraoke,i.prototype.parse_decimal,!0),n("kf",e.parts.SweepingColorKaraoke,i.prototype.parse_decimal,!0),n("ko",e.parts.OutlineKaraoke,i.prototype.parse_decimal,!0),n("p",e.parts.DrawingMode,i.prototype.parse_decimal,!0),n("pbo",e.parts.DrawingBaselineOffset,i.prototype.parse_decimal,!0),n("s",e.parts.StrikeThrough,i.prototype.parse_enableDisable,!1),n("shad",e.parts.Shadow,i.prototype.parse_decimal,!1),n("u",e.parts.Underline,i.prototype.parse_enableDisable,!1),n("xbord",e.parts.BorderX,i.prototype.parse_decimal,!1),n("xshad",e.parts.ShadowX,i.prototype.parse_decimal,!1),n("ybord",e.parts.BorderY,i.prototype.parse_decimal,!1),n("yshad",e.parts.ShadowY,i.prototype.parse_decimal,!1),n("1a",e.parts.PrimaryAlpha,i.prototype.parse_alpha,!1),n("1c",e.parts.PrimaryColor,i.prototype.parse_color,!1),n("2a",e.parts.SecondaryAlpha,i.prototype.parse_alpha,!1),n("2c",e.parts.SecondaryColor,i.prototype.parse_color,!1),n("3a",e.parts.OutlineAlpha,i.prototype.parse_alpha,!1),n("3c",e.parts.OutlineColor,i.prototype.parse_color,!1),n("4a",e.parts.ShadowAlpha,i.prototype.parse_alpha,!1),n("4c",e.parts.ShadowColor,i.prototype.parse_color,!1);var a=new e.Map;Object.keys(i.prototype).forEach(function(e){0===e.indexOf("parse_")&&"function"==typeof i.prototype[e]&&a.set(e.substr("parse_".length),i.prototype[e])});var o=function(){function e(e,t){"undefined"==typeof t&&(t=null),this._J=e,this._n=[],null!==e&&e._n.push(this),this._g=null!==e?e.end:0,null!==t?this.value=t:this._D(this._g)}return Object.defineProperty(e.prototype,"start",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._f},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this._J},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._n},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._a},set:function(e){this._a=e,this._a.constructor===String&&0===this._n.length&&this._D(this._g+this._a.length)},enumerable:!0,configurable:!0}),e.prototype.pop=function(){this._n.splice(this._n.length-1,1),this._n.length>0?this._D(this._n[this._n.length-1].end):this._D(this.start)},e.prototype._D=function(e){this._f=e,null!==this._J&&this._J.end!==this._f&&this._J._D(this._f)},e}()}(e.parser||(e.parser={}))}(libjass||(libjass={})),function(e){!function(t){var r=function(){function t(e,t,r){var n=this;this._h=e,this._ap=t,this._Z=r,this._B=null,a.prototype.initializeUnsetProperties.call(this._Z),this._t=this._ap.dialogues.slice(0),this._t.sort(function(e,t){var r=e.start-t.start;return 0===r&&(r=e.id-t.id),r}),this._7=this._t.map(function(e){return e.end}),this._h.addEventListener("timeupdate",function(){return n._aM()},!1),this._h.addEventListener("seeking",function(){return n._aL()},!1),this._h.addEventListener("pause",function(){return n._al()},!1),this._h.addEventListener("playing",function(){return n._R()},!1)}return Object.defineProperty(t.prototype,"video",{get:function(){return this._h},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ass",{get:function(){return this._ap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"settings",{get:function(){return this._Z},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this._o},enumerable:!0,configurable:!0}),t.prototype.onVideoTimeUpdate=function(){this._o=this._h.currentTime,e.debugMode&&console.log("NullRenderer.onVideoTimeUpdate: "+this._K());for(var t=0,r=this._7.length;t!==r;){var n=(t+r)/2|0;this._7[n]<this._o?t=n+1:r=n}for(var i=t;i<this._7.length;i++){var a=this._t[i];if(a.start<=this._o)this.draw(a);else{if(!(a.start<=this._o+this._Z.preRenderTime))break;this.preRender(a)}}},t.prototype.onVideoSeeking=function(){e.debugMode&&console.log("NullRenderer.onVideoSeeking: "+this._K())},t.prototype.onVideoPause=function(){e.debugMode&&console.log("NullRenderer.onVideoPause: "+this._K()),null!==this._B&&(clearInterval(this._B),this._B=null)},t.prototype.onVideoPlaying=function(){var r=this;e.debugMode&&console.log("NullRenderer.onVideoPlaying: "+this._K()),null===this._B&&(this._B=setInterval(function(){return r._aJ()},t._aH))},t.prototype.preRender=function(){},t.prototype.draw=function(){},t.prototype._aM=function(){2===this._y&&this._o!==this._h.currentTime&&this._R()},t.prototype._aJ=function(){this._o!==this._h.currentTime&&(0!==this._y&&this._R(),this.onVideoTimeUpdate())},t.prototype._aL=function(){2!==this._y&&(this._al(),this._y=2),this._o!==this._h.currentTime&&(this._o=this._h.currentTime,this.onVideoSeeking())},t.prototype._al=function(){this._y=1,this.onVideoPause()},t.prototype._R=function(){this._y=0,this.onVideoPlaying()},t.prototype._K=function(){return"video.currentTime = "+this._h.currentTime+", video.paused = "+this._h.paused+", video.seeking = "+this._h.seeking},t._aH=41,t}();t.NullRenderer=r;var n;!function(e){e[e.Playing=0]="Playing",e[e.Paused=1]="Paused",e[e.Seeking=2]="Seeking"}(n||(n={}));var i=function(t){function r(r,n,i){var a=this;t.call(this,r,n,i),this._q=[],this._v=new e.Map,this._C=new e.Map,this._z=!1,this._M=new e.Map,this._s=document.createElement("div"),r.parentElement.replaceChild(this._s,r),this._s.className="libjass-wrapper",this._s.appendChild(r),this._l=document.createElement("div"),this._s.appendChild(this._l),this._l.className="libjass-subs";var o=new e.Map;this.ass.dialogues.forEach(function(e){o.set(e.layer+","+e.alignment,[e.layer,e.alignment])});var l=[];if(o.forEach(function(e){l.push(e)}),l.sort(function(e,t){var r=e[0]-t[0];return 0!==r?r:e[1]-t[1]}).forEach(function(e){var t=e[0],r=e[1];if(void 0===a._q[t]){a._q[e[0]]=new Array(10);var n=document.createElement("div");n.className="layer"+t+" an0",a._l.appendChild(n),a._q[t][0]=n}var n=document.createElement("div");n.className="layer"+t+" an"+r,a._l.appendChild(n),a._q[t][r]=n}),this.settings.preLoadFonts){var s=new e.Set;Object.keys(this.ass.styles).map(function(e){return a.ass.styles[e]}).forEach(function(e){s.add(e.fontName)}),this.ass.dialogues.forEach(function(t){t.parts.forEach(function(t){t instanceof e.parts.FontName&&s.add(t.value)})});var u=[];this.settings.fontMap.forEach(function(e,t){s.has(t)&&u.unshift.apply(u,e)});var p=u.length;e.debugMode&&console.log("Preloading fonts..."),u.forEach(function(t){var r=new XMLHttpRequest;return r.open("GET",t,!0),r.addEventListener("readystatechange",function(){r.readyState===XMLHttpRequest.DONE&&(e.debugMode&&console.log("Preloaded "+t+"."),--p,e.debugMode&&console.log(p+" fonts left to preload."),0===p&&(e.debugMode&&console.log("All fonts have been preloaded."),a._0()))},!1),r.send(null),r}),e.debugMode&&console.log(p+" fonts left to preload."),0===p&&setTimeout(function(){e.debugMode&&console.log("All fonts have been preloaded."),a._0()},0)}else setTimeout(function(){return a._0()},0);this._M.set("ready",[]),this._M.set("fullScreenChange",[])}return __extends(r,t),r.prototype.addEventListener=function(e,t){var r=this._M.get(e);null!==r&&r.push(t)},r.prototype.resizeVideo=function(e,t){this._au(),this.video.style.width=e.toFixed(3)+"px",this.video.style.height=t.toFixed(3)+"px";var n=Math.min(e/this.ass.resolutionX,t/this.ass.resolutionY),i=this.ass.resolutionX*n,a=this.ass.resolutionY*n;if(this._l.style.width=i.toFixed(3)+"px",this._l.style.height=a.toFixed(3)+"px",this._l.style.left=((e-i)/2).toFixed(3)+"px",this._l.style.top=((t-a)/2).toFixed(3)+"px",this.ass.scaleTo(i,a),this._C.clear(),null!==r._p)for(;null!==r._p.firstChild;)r._p.removeChild(r._p.firstChild);if(null!==r._m)for(;null!==r._m.firstChild;)r._m.removeChild(r._m.firstChild);this.onVideoTimeUpdate()},r.prototype.onVideoSeeking=function(){t.prototype.onVideoSeeking.call(this),this._au()},r.prototype.onVideoTimeUpdate=function(){var e=this;t.prototype.onVideoTimeUpdate.call(this),this._v.forEach(function(t,r){var n=e.ass.dialogues[r];(n.start>e.currentTime||n.end<e.currentTime)&&(e._v.delete(r),e._ax(t))})},r.prototype.onVideoPause=function(){t.prototype.onVideoPause.call(this),r._ay(this._l,"paused")},r.prototype.onVideoPlaying=function(){t.prototype.onVideoPlaying.call(this),r._az(this._l,"paused")},r.prototype.preRender=function(t){var n=this;if(!this._C.has(t.id)){var i=document.createElement("div"),a=this.ass.scaleX,u=this.ass.scaleY,p=this.ass.dpi;switch(i.style.marginLeft=a*t.style.marginLeft+"px",i.style.marginRight=a*t.style.marginRight+"px",i.style.marginTop=i.style.marginBottom=u*t.style.marginVertical+"px",t.alignment){case 1:case 4:case 7:i.style.textAlign="left";break;case 2:case 5:case 8:i.style.textAlign="center";break;case 3:case 6:case 9:i.style.textAlign="right"}var c=new l(t.id,t.start,t.end),h="";null===r._m&&(r._m=document.querySelector("#svg-filters"));var f=null,_=new s(t.id,t.style,t.transformOrigin,a,u,p,r._m),d=function(){null!==f&&(_.setStylesOnSpan(f),i.appendChild(f)),f=document.createElement("span")};if(d(),t.parts.forEach(function(r){if(r instanceof e.parts.Italic)_.italic=r.value;else if(r instanceof e.parts.Bold)_.bold=r.value;else if(r instanceof e.parts.Underline)_.underline=r.value;else if(r instanceof e.parts.StrikeThrough)_.strikeThrough=r.value;else if(r instanceof e.parts.Border)_.outlineWidthX=r.value,_.outlineWidthY=r.value;else if(r instanceof e.parts.BorderX)_.outlineWidthX=r.value;else if(r instanceof e.parts.BorderY)_.outlineWidthY=r.value;else if(r instanceof e.parts.GaussianBlur)_.blur=r.value;else if(r instanceof e.parts.FontName)_.fontName=r.value;else if(r instanceof e.parts.FontSize)_.fontSize=r.value;else if(r instanceof e.parts.FontScaleX)_.fontScaleX=r.value;else if(r instanceof e.parts.FontScaleY)_.fontScaleY=r.value;else if(r instanceof e.parts.LetterSpacing)_.letterSpacing=r.value;else if(r instanceof e.parts.RotateX)h+=" rotateX("+r.value+"deg)";else if(r instanceof e.parts.RotateY)h+=" rotateY("+r.value+"deg)";else if(r instanceof e.parts.RotateZ)h+=" rotateZ("+-1*r.value+"deg)";else if(r instanceof e.parts.SkewX)h+=" skewX("+45*r.value+"deg)";else if(r instanceof e.parts.SkewY)h+=" skewY("+45*r.value+"deg)";else if(r instanceof e.parts.PrimaryColor)_.primaryColor=r.value;else if(r instanceof e.parts.OutlineColor)_.outlineColor=r.value;else if(r instanceof e.parts.Alpha)_.primaryAlpha=r.value,_.outlineAlpha=r.value;else if(r instanceof e.parts.PrimaryAlpha)_.primaryAlpha=r.value;else if(r instanceof e.parts.OutlineAlpha)_.outlineAlpha=r.value;else if(r instanceof e.parts.Alignment);else if(r instanceof e.parts.Reset){var l=r.value,s=null;null!==l&&(s=n.ass.styles[l]),_.reset(s)}else if(r instanceof e.parts.Position){var p=r;i.style.position="absolute",i.style.left=(a*p.x).toFixed(3)+"px",i.style.top=(u*p.y).toFixed(3)+"px"}else if(r instanceof e.parts.Move){var g=r;i.style.position="absolute",c.addCustom("linear",new o(0,{left:(a*g.x1).toFixed(3)+"px",top:(u*g.y1).toFixed(3)+"px"}),new o(g.t1,{left:(a*g.x1).toFixed(3)+"px",top:(u*g.y1).toFixed(3)+"px"}),new o(g.t2,{left:(a*g.x2).toFixed(3)+"px",top:(u*g.y2).toFixed(3)+"px"}),new o(t.end-t.start,{left:(a*g.x2).toFixed(3)+"px",top:(u*g.y2).toFixed(3)+"px"}))}else if(r instanceof e.parts.Fade){var v=r;0!==v.start&&c.addFadeIn(0,v.start),0!==v.end&&c.addFadeOut(t.end-t.start-v.end,v.end)}else if(r instanceof e.parts.ComplexFade){var y=r;c.addCustom("linear",new o(0,{opacity:String(y.a1)}),new o(y.t1,{opacity:String(y.a1)}),new o(y.t2,{opacity:String(y.a2)}),new o(y.t3,{opacity:String(y.a2)}),new o(y.t4,{opacity:String(y.a3)}),new o(t.end,{opacity:String(y.a3)}))}else(r instanceof e.parts.Text||e.debugMode&&r instanceof e.parts.Comment)&&(f.appendChild(document.createTextNode(r.value)),d())}),t.parts.some(function(r){if(r instanceof e.parts.Position||r instanceof e.parts.Move){var n=-t.transformOriginX,a=-t.transformOriginY;return h="translate("+n+"%, "+a+"%) translate(-"+i.style.marginLeft+", -"+i.style.marginTop+") "+h,!0}return!1}),""!==h&&(i.style.webkitTransform=h,i.style.webkitTransformOrigin=t.transformOrigin,i.style.transform=h,i.style.transformOrigin=t.transformOrigin),null===r._p){var g=document.querySelector("#libjass-animation-styles");null===g&&(g=document.createElement("style"),g.id="libjass-animation-styles",g.type="text/css",document.querySelector("head").appendChild(g)),r._p=g}r._p.appendChild(document.createTextNode(c.cssText)),i.style.webkitAnimation=c.animationStyle,i.style.animation=c.animationStyle,i.setAttribute("data-dialogue-id",String(t.id)),this._C.set(t.id,i)}},r.prototype.draw=function(t){var r=this;if(!this._v.has(t.id)){e.debugMode&&console.log(t.toString());var n=this._C.get(t.id);void 0===n&&(e.debugMode&&console.warn("This dialogue was not pre-rendered. Call preRender() before calling draw() so that draw() is faster."),this.preRender(t),n=this._C.get(t.id));var i=n.cloneNode(!0),a=i.style.webkitAnimationDelay;if(void 0===a&&(a=i.style.animationDelay),""!==a){var o=a.split(",").map(function(e){return(parseFloat(e)+t.start-r.currentTime).toFixed(3)+"s"}).join(",");i.style.webkitAnimationDelay=o,i.style.animationDelay=o}"absolute"===i.style.position?this._q[t.layer][0].appendChild(i):this._q[t.layer][t.alignment].appendChild(i),this._v.set(t.id,i)}},r.prototype._0=function(){var e=this;document.addEventListener("webkitfullscreenchange",function(){return e._3()},!1),document.addEventListener("mozfullscreenchange",function(){return e._3()},!1),document.addEventListener("fullscreenchange",function(){return e._3()},!1),this.resizeVideo(parseInt(this.video.style.width),parseInt(this.video.style.height)),this._4("ready")},r.prototype._3=function(){var e=document.fullscreenElement;void 0===e&&(e=document.mozFullScreenElement),void 0===e&&(e=document.msFullscreenElement),void 0===e&&(e=document.webkitFullscreenElement),e===this.video?(r._ay(this._s,"libjass-full-screen"),this.resizeVideo(screen.width,screen.height),this._z=!0,this._4("fullScreenChange",this._z)):null===e&&this._z&&(r._az(this._s,"libjass-full-screen"),this._z=!1,this._4("fullScreenChange",this._z))},r.prototype._4=function(e){for(var t=[],r=0;r<arguments.length-1;r++)t[r]=arguments[r+1];var n=this,i=this._M.get(e);null!==i&&i.forEach(function(e){e.apply(n,t)})},r.prototype._ax=function(e){e.parentNode.removeChild(e)},r.prototype._au=function(){var e=this;this._v.forEach(function(t){return e._ax(t)}),this._v.clear()},r.makeFontMapFromStyleElement=function(t){var n=new e.Map,i=t.sheet,a=Array.prototype.filter.call(i.cssRules,function(e){return e.type===CSSRule.FONT_FACE_RULE});return a.forEach(function(e){var t=e.style.getPropertyValue("src"),i=[];if(t||(t=e.cssText.split("\n").map(function(e){return e.match(/src: ([^;]+);/)}).filter(function(e){return null!==e}).map(function(e){return e[1]})[0]),i=t.split(/,\s*/).map(function(e){return e.match(/^url\((.+)\)$/)[1]}),i.length>0){var a=r._aj(e.style.getPropertyValue("font-family")),o=n.get(a);void 0===o&&(o=[],n.set(a,o)),o.unshift.apply(o,i.map(r._aj))}}),n},r._aj=function(e){return e.match(/^["']?(.*?)["']?$/)[1]},r._ay=function(e,t){var r=e.className.split(" ").map(function(e){return e.trim()}).filter(function(e){return!!e});-1===r.indexOf(t)&&(e.className+=" "+t)},r._az=function(e,t){var r=e.className.split(" ").map(function(e){return e.trim()}).filter(function(e){return!!e}),n=r.indexOf(t);-1!==n&&(e.className=r.slice(0,n).join(" ")+" "+r.slice(n+1).join(" "))},r._p=null,r._m=null,r}(r);t.DefaultRenderer=i;var a=function(){function e(){}return e.prototype.initializeUnsetProperties=function(){void 0===this.preLoadFonts&&(this.preLoadFonts=!1),void 0===this.fontMap&&(this.fontMap=null),void 0===this.preRenderTime&&(this.preRenderTime=5)},e}();t.RendererSettings=a;var o=function(){function e(e,t){this._aE=e,this._aD=t}return Object.defineProperty(e.prototype,"time",{get:function(){return this._aE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"properties",{get:function(){return this._aD},enumerable:!0,configurable:!0}),e}(),l=function(){function e(e,t,r){this._r=e,this._g=t,this._f=r,this._an="",this._i="",this._aP=0}return Object.defineProperty(e.prototype,"cssText",{get:function(){return this._an},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationStyle",{get:function(){return this._i},enumerable:!0,configurable:!0}),e.prototype.addFadeIn=function(e,t){""!==this._i&&(this._i+=","),this._i+="fade-in "+t.toFixed(3)+"s linear "+e.toFixed(3)+"s"},e.prototype.addFadeOut=function(e,t){""!==this._i&&(this._i+=","),this._i+="fade-out "+t.toFixed(3)+"s linear "+e.toFixed(3)+"s"},e.prototype.addCustom=function(e){for(var t=[],r=0;r<arguments.length-1;r++)t[r]=arguments[r+1];var n=this,i=null,a=null,o="";t.forEach(function(e){null===i&&(i=e.time),a=e.time,o+="	"+(100*e.time/(n._f-n._g)).toFixed(3)+"% {\n",Object.keys(e.properties).forEach(function(t){o+="		"+t+": "+e.properties[t]+";\n"}),o+="	}\n"});var l="dialogue-"+this._r+"-"+this._aP++;this._an+="@-webkit-keyframes "+l+" {\n"+o+"}\n\n@keyframes "+l+" {\n"+o+"}\n\n",""!==this._i&&(this._i+=","),this._i+=l+" "+(a-i).toFixed(3)+"s "+e+" "+i.toFixed(3)+"s"},e}(),s=function(){function e(e,t,r,n,i,a,o){this._r=e,this._c=t,this._P=r,this._G=n,this._F=i,this._ab=a,this._m=o,this._aC=0,this.reset(null)}return e.prototype.reset=function(e){(void 0===e||null===e)&&(e=this._c),this.italic=e.italic,this.bold=e.bold,this.underline=e.underline,this.strikeThrough=e.strikeThrough,this.outlineWidthX=e.outlineWidth,this.outlineWidthY=e.outlineWidth,this.fontName=e.fontName,this.fontSize=e.fontSize,this.fontScaleX=e.fontScaleX,this.fontScaleY=e.fontScaleY,this.letterSpacing=e.letterSpacing,this.primaryColor=e.primaryColor,this.outlineColor=e.outlineColor,this.primaryAlpha=null,this.outlineAlpha=null,this.blur=null},e.prototype.setStylesOnSpan=function(t){var r="";this._ad&&(r+="italic "),this._A===!0?r+="bold ":this._A!==!1&&(r+=this._A+" ");var n=(72/this._ab*this._F*this._af).toFixed(3);t.style.font=r+n+"px/"+n+'px "'+this._ag+'"';var i="";this._ah&&(i="underline"),this._ac&&(i+=" line-through"),t.style.textDecoration=i.trim();var a="";1!=this._O&&(a+="scaleX("+this._O+") "),1!=this._N&&(a+="scaleY("+this._N+")"),""!==a&&(t.style.webkitTransform=a,t.style.webkitTransformOrigin=this._P,t.style.transform=a,t.style.transformOrigin=this._P,t.style.display="inline-block"),t.style.letterSpacing=(this._G*this._5).toFixed(3)+"px",t.style.color=this._U.withAlpha(this._aG).toString();var o=this._T.withAlpha(this._aI),l=this._G*this._at,s=this._F*this._aq,u="svg-filter-"+this._r+"-"+this._aC++,p=[],c=[],h="";if(0===l&&0===s)h='	<feGaussianBlur stdDeviation="'+this._ak+'" in="outlineColor" result="outline" />\n';else{for(var f=this._G*this._at,_=this._F*this._aq,d=0,g=0;f>g;g++)for(var v=0;_>v&&1>=g/f*(g/f)+v/_*(v/_);v++)p.push([g,v]),0!==g&&p.push([-g,v]),0!==g&&0!==v&&p.push([-g,-v]),0!==v&&p.push([g,-v]);p.push([f,0]),p.push([0,_]),p.push([-f,0]),p.push([0,-_]),p.forEach(function(e){h+='	<feOffset dx="'+e[0]+'px" dy="'+e[1]+'px" in="outlineColor" result="outline'+d+'" />\n',c.push("outline"+d),d++}),h+='	<feMerge result="outlines">'+c.map(function(e){return'		<feMergeNode in="'+e+'" />\n'}).join("")+'	</feMerge>\n	<feGaussianBlur stdDeviation="'+this._ak+'" in="outlines" result="outline" />\n'}var y='<filter xmlns="http://www.w3.org/2000/svg" id="'+u+'">\n	<feComponentTransfer in="SourceAlpha" result="outlineColor">\n		<feFuncR type="linear" slope="'+(o.red/255*o.alpha).toFixed(3)+'" />\n		<feFuncG type="linear" slope="'+(o.green/255*o.alpha).toFixed(3)+'" />\n		<feFuncB type="linear" slope="'+(o.blue/255*o.alpha).toFixed(3)+'" />\n	</feComponentTransfer>\n'+h+'	<feMerge>\n		<feMergeNode in="outline" />\n		<feMergeNode in="SourceGraphic" />\n	</feMerge>\n</filter>';null===e._9&&(e._9=new DOMParser);var m=e._9.parseFromString(y,"image/svg+xml").childNodes[0];this._m.appendChild(m),t.style.webkitFilter='url("#'+u+'")',t.style.filter='url("#'+u+'")'},Object.defineProperty(e.prototype,"italic",{set:function(t){this._ad=e._e(t,this._c.italic)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bold",{set:function(t){this._A=e._e(t,this._c.bold)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"underline",{set:function(t){this._ah=e._e(t,this._c.underline)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strikeThrough",{set:function(t){this._ac=e._e(t,this._c.strikeThrough)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineWidthX",{set:function(t){this._at=e._e(t,this._c.outlineWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineWidthY",{set:function(t){this._aq=e._e(t,this._c.outlineWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"blur",{set:function(t){this._ak=e._e(t,0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontName",{set:function(t){this._ag=e._e(t,this._c.fontName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{set:function(t){this._af=e._e(t,this._c.fontSize)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleX",{set:function(t){this._O=e._e(t,this._c.fontScaleX)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fontScaleY",{set:function(t){this._N=e._e(t,this._c.fontScaleY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"letterSpacing",{set:function(t){this._5=e._e(t,this._c.letterSpacing)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryColor",{set:function(t){this._U=e._e(t,this._c.primaryColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineColor",{set:function(t){this._T=e._e(t,this._c.outlineColor)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"primaryAlpha",{set:function(e){this._aG=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outlineAlpha",{set:function(e){this._aI=e},enumerable:!0,configurable:!0}),e._9=null,e._e=function(e,t){return null!==e?e:t},e}()}(e.renderers||(e.renderers={}))}(libjass||(libjass={})),function(e){var t=function(){function t(t){var i=this;this._av=Object.create(null),this._t=[],t=t.replace(/\r$/gm,"");var a=e.parser.parse(t,"script"),o=a["Script Info"];e.verboseMode&&console.log("Read script info: "+JSON.stringify(o),o),this._ai=parseInt(o.PlayResX),this._aA=parseInt(o.PlayResY),a["V4+ Styles"].forEach(function(t){if("Style"===t.type){var n=t.template;e.verboseMode&&console.log("Read style: "+JSON.stringify(n),n);var a=new r(n);i._av[a.name]=a}}),a.Events.forEach(function(t){if("Dialogue"===t.type){var r=t.template;e.verboseMode&&console.log("Read dialogue: "+JSON.stringify(r),r),i._t.push(new n(r,i))}})}return Object.defineProperty(t.prototype,"resolutionX",{get:function(){return this._ai},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"resolutionY",{get:function(){return this._aA},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return this._G},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleY",{get:function(){return this._F},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dpi",{get:function(){return this._ab},set:function(e){this._ab=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return this._av},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dialogues",{get:function(){return this._t},enumerable:!0,configurable:!0}),t.prototype.scaleTo=function(e,t){this._G=e/this._ai,this._F=t/this._aA},t}();e.ASS=t;var r=function(){function t(t){this._8=t.Name,this._ad="-1"===t.Italic,this._A="-1"===t.Bold,this._ah="-1"===t.Underline,this._ac="-1"===t.StrikeOut,this._ag=t.Fontname,this._af=parseFloat(t.Fontsize),this._O=parseFloat(t.ScaleX)/100,this._N=parseFloat(t.ScaleY)/100,this._5=parseFloat(t.Spacing),this._U=e.parser.parse(t.PrimaryColour,"colorWithAlpha"),this._T=e.parser.parse(t.OutlineColour,"colorWithAlpha"),this._aR=parseFloat(t.Outline),this._x=parseInt(t.Alignment),this._aT=parseFloat(t.MarginL),this._aU=parseFloat(t.MarginR),this._aV=parseFloat(t.MarginV)}return Object.defineProperty(t.prototype,"name",{get:function(){return this._8},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"italic",{get:function(){return this._ad},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bold",{get:function(){return this._A},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"underline",{get:function(){return this._ah},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"strikeThrough",{get:function(){return this._ac},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontName",{get:function(){return this._ag},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._af},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontScaleX",{get:function(){return this._O},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontScaleY",{get:function(){return this._N},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"letterSpacing",{get:function(){return this._5},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"primaryColor",{get:function(){return this._U},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineColor",{get:function(){return this._T},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineWidth",{get:function(){return this._aR},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignment",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"marginLeft",{get:function(){return this._aT},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"marginRight",{get:function(){return this._aU},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"marginVertical",{get:function(){return this._aV},enumerable:!0,configurable:!0}),t}();e.Style=r;var n=function(){function t(r,n){var i=this;if(this._a0=null,this._r=++t._aX,this._c=n.styles[r.Style],this._g=t._aw(r.Start),this._f=t._aw(r.End),this._aZ=Math.max(parseInt(r.Layer),0),this._x=this._c.alignment,this._w=e.parser.parse(r.Text,"dialogueParts"),this._w.forEach(function(t,r){if(t instanceof e.parts.Alignment)i._x=t.value;
else if(t instanceof e.parts.Move){var n=t;(null===n.t1||null===n.t2)&&(i._w[r]=new e.parts.Move(n.x1,n.y1,n.x2,n.y2,0,i._f-i._g))}else if(t instanceof e.parts.Transform){var a=t;(null===a.start||null===a.end||null===a.accel)&&(i._w[r]=new e.parts.Transform(null===a.start?0:a.start,null===a.end?i._f-i._g:a.end,null===a.accel?1:a.accel,a.tags))}}),this._aW(),e.debugMode){var a=this._w.filter(function(t){return t instanceof e.parts.Comment&&-1!==t.value.indexOf("\\")});a.length>0&&console.warn("Possible incorrect parse:\n"+r.Text+"\nwas parsed as\n"+this.toString()+"\nThe possibly incorrect parses are:\n"+a.join("\n"))}}return Object.defineProperty(t.prototype,"id",{get:function(){return this._r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this._g},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this._f},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._c},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alignment",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transformOriginX",{get:function(){return this._k},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transformOriginY",{get:function(){return this._j},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transformOrigin",{get:function(){return this._P},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"layer",{get:function(){return this._aZ},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parts",{get:function(){return this._w},enumerable:!0,configurable:!0}),t.prototype.toString=function(){return"#"+this._r+" ["+this._g.toFixed(3)+"-"+this._f.toFixed(3)+"] "+this._w.join(", ")},t._aw=function(e){return e.split(":").reduce(function(e,t){return 60*e+parseFloat(t)},0)},t.prototype._aW=function(){switch(this._x){case 1:this._k=0,this._j=100;break;case 2:this._k=50,this._j=100;break;case 3:this._k=100,this._j=100;break;case 4:this._k=0,this._j=50;break;case 5:this._k=50,this._j=50;break;case 6:this._k=100,this._j=50;break;case 7:this._k=0,this._j=0;break;case 8:this._k=50,this._j=0;break;case 9:this._k=100,this._j=0}this._P=this._k+"% "+this._j+"%"},t._aX=-1,t}();e.Dialogue=n,e.debugMode=!1,e.verboseMode=!1}(libjass||(libjass={}));
//# sourceMappingURL=libjass.min.js.map